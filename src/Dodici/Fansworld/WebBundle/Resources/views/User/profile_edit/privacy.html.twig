{% extends "DodiciFansworldWebBundle:User:profile_edit_base.html.twig" %}

{% block user_edit_toolbar %}
	{% set current_edit_toolbar = 'privacy' %}
	{{ parent() }}
{% endblock %}

{% block profile_edit_body %}

<div class="row-fluid">
    <h3>Preferencias de privacidad</h3>
    <dl  class="privacies dl-horizontal">
        {% for field, value in privacyFields %}
            <dt>{{ field }}</dt>
                <dd class="btn-group" data-toggle="buttons-radio">
                        <button class="btn {% if value=='everyone' %}active{% endif %}" data-field="{{field}}" data-value="everyone">PÃºblico</button>
                        <button class="btn {% if value=='friends_only' %}active{% endif %}" data-field="{{field}}" data-value="friends_only">Solo Fans</button>
                        <button class="btn {% if value=='only_me' %}active{% endif %}" data-field="{{field}}" data-value="only_me">Privado</button>
                </dd>
        {% endfor %}
    </dl>
</div>

<script type="text/javascript">
    $(document).ready(function(){
        $("dl.privacies button.btn").click(function(){
            var privacies = {};
            
            $(".privacies button").addClass('disabled');
            
            $(".privacies dd").each(function(i, element){
                var field = $(element).find('.active').attr('data-field');
                var value = $(element).find('.active').attr('data-value');
                privacies[field] = value;
            });
            
            ajax.genericAction('profile_ajaxprivacy', {
                'privacy' : privacies,
            }, function(response){
                success(response.error);
                $(".privacies button").removeClass('disabled');
            }, function(e){
                error(e);
            });
        });
    });
</script>

{% endblock %}