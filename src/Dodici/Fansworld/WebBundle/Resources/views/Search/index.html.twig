{% extends "DodiciFansworldWebBundle:Layout:one_column.html.twig" %}

{% block javascripts %}
	{{ parent() }}
	<script src="{{ asset('bundles/dodicifansworldweb/js/search.js') }}" type="text/javascript"></script>
{% endblock %}

{% block main_content %}
    <div class="row-fluid search-home">
        <div class="span10">
            <div class="btn-group" data-toggle="buttons-radio">
                <button type="button" class="btn active" data-filter-type="all">Todo <span class="badge">{{ todoCount }}</span></button>
                <button type="button" class="btn" data-filter-type="video">Tv <span class="badge">{{ videoCount }}</span></button>
                <button type="button" class="btn" data-filter-type="idol">Idolos <span class="badge">{{ idolCount }}</span></button>
                <button type="button" class="btn" data-filter-type="user">Fans <span class="badge">{{ fanCount }}</span></button>
                <button type="button" class="btn" data-filter-type="team">Equipos <span class="badge">{{ teamCount }}</span></button>
                <button type="button" class="btn" data-filter-type="photo">Fotos <span class="badge">{{ photoCount }}</span></button>
                <button type="button" class="btn" data-filter-type="event">Partidos <span class="badge">{{ eventCount }}</span></button>
            </div>

            {% embed "DodiciFansworldWebBundle:Search/blocks:section_search_roller.html.twig" with {'entityType': 'video', 'title': 'videos'} %}
                {% block roller %}
                    {% include "DodiciFansworldWebBundle:Search:blocks/video_element_list.html.twig"  with { videos: videos } %}
                {% endblock %}
            {% endembed %}

            {% embed "DodiciFansworldWebBundle:Search/blocks:section_search_roller.html.twig" with {'entityType': 'idol', 'title': 'idolos'} %}
                {% block roller %}
                    {% include "DodiciFansworldWebBundle:Default:blocks/avatar_grid.html.twig" with { avatars: idols, type: 'idols' } %}
                {% endblock %}
            {% endembed %}

            {% embed "DodiciFansworldWebBundle:Search/blocks:section_search_roller.html.twig" with {'entityType': 'user', 'title': 'fans'} %}
                {% block roller %}
                    {% include "DodiciFansworldWebBundle:Default:blocks/avatar_grid.html.twig" with { avatars: fans, type: 'fans' } %}
                {% endblock %}
            {% endembed %}

            {% embed "DodiciFansworldWebBundle:Search/blocks:section_search_roller.html.twig" with {'entityType': 'photo', 'title': 'fotos'} %}
                {% block roller %}
                    {% include 'DodiciFansworldWebBundle:Photo:blocks/montage.html.twig' with {photos: photos} %}
                {% endblock %}
            {% endembed %}
                
            {% embed "DodiciFansworldWebBundle:Search/blocks:section_search_roller.html.twig" with {'entityType': 'team', 'title': 'equipos'} %}
                {% block roller %}
                    {% include "DodiciFansworldWebBundle:Default:blocks/avatar_grid.html.twig" with { avatars: teams, type: 'teams'} %}
                {% endblock %}
            {% endembed %}

            {% embed "DodiciFansworldWebBundle:Search/blocks:section_search_roller.html.twig" with {'entityType': 'event', 'title': 'partidos'} %}
                {% block roller %}
                    {% include "DodiciFansworldWebBundle:Event:blocks/grid.html.twig" with {'event': events} %}
                {% endblock %}
            {% endembed %}
        </div>
        <div class="span2 trending-sidebar">
            <h4>DESTACADOS DE FANSWORLD</h4>
            <section class="search video">
                {% include "DodiciFansworldWebBundle:Search:blocks/video_element_list.html.twig"  with { videos: videosHighlighted } %}
            </section>
            <h4>#TRENDY</h4>
            <ul id="wordcloud">
            </ul>
        </div>
    </div>

    <script type="text/javascript">
        var word_array = [
                {% for tag in trending %}
                    {% set link = '' %}
                    {% if tag.type == 'team' or tag.type == 'idol' %}
                        {% set link = path( tag.type ~ '_wall', {'slug': tag.slug}) %}
                    {% endif %}
                    {% if tag.type == 'user' %}
                        {% set link = path('user_land', {'username': tag.username}) %}
                    {% endif %}
                    {% if tag.type == 'tag' %}
                        {% set link = path('search_home', {'query': tag.title, 'tag': true}) %}
                    {% endif %}
                        
                    {text: "{{ tag.title }}", weight: {{ tag.count }}, link: "{{ link }}", type: "{{ tag.type }}"},
                {% endfor %}
        ];
        $("#wordcloud").wordcloud(word_array, {});
    </script>
{% endblock %}