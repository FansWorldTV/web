{% extends "DodiciFansworldWebBundle:Layout:three_column.html.twig" %}

{% block title %}{{ parent() }} - {{ 'Contents'|trans }}{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('bundles/dodicifansworldweb/js/contest.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/dodicifansworldweb/js/popup.js') }}" type="text/javascript"></script>
{% endblock  %}

{% block content %}
<div class="col_468 left margin contests">
    <div class="cont clearfix">
        <div class="nota_ampliada">

            <div class="media">
            	<h2{% if contest.image is null %} class="noimage"{% endif %}>{{ contest.title }}</h2>
            	{% if contest.image %}
            		{% thumbnail contest.image, 'big' with {'class': 'articleimg'} %}
            	{% endif %}
            	{% include 'DodiciFansworldWebBundle:Default:share.html.twig' with {entity: contest} %}
            </div>
            <div class="hidden" id="formParticipate">
                <form action="" class="formParticipate">
                    <textarea name="content"></textarea>
                    <input type="submit" value="{{ 'Participate'|trans }}" name="submit"/>
                </form>
            </div>
            <div class="contenido">
                <div class="text">
                    {{ contest.content|raw() }}
                </div>
                {% if isParticipant %}
                    <div class="options">{{ 'Already participating'|trans }}</div>
                {% else %}
                    <div class="options"><a class="btn_action2 contestParticipate" href="#1">{{ 'Participate'|trans }}</a></div>
                {% endif %}
            </div>
            
            <input type="hidden" id="contestId" value="{{ contest.id }}"/>
            <input type="hidden" id="contestType" value="{{ contest.type }}"/>
            
            <hr/>
            
            {% set typeParticipate = constant('Dodici\\Fansworld\\WebBundle\\Entity\\Contest::TYPE_PARTICIPATE') %}
            {% if contest.type != typeParticipate %}
                <div id="tabs" class="marginTop10">
                    <ul>
                        <li><a href="#tabs-1">{{ 'Participants'|trans }}</a></li>
                        <li><a href="#tabs-2">{{ 'Winners'|trans }}</a></li>
                        {% if contest.type > 1 %}
                            <li><a href="#tabs-3">{{ 'Publications'|trans }}</a></li>
                        {% endif %}
                    </ul>
                    <div id="tabs-1">
                        <ul>
                            {% for participant in participants %}
                                <li>{{ participant.author }}</li>
                            {% endfor %}
                        </ul>
                        {% if addMoreParticipants %}
                            <div class="morelink">
                                <a id="addMoreParticipants" href="">{{ 'View more'|trans }}</a>
                            </div>
                        {% endif %}
                    </div>
                    <div id="tabs-2">
                        <ul>
                            {% for winner in winners %}
                                <li>{{ winner.author }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div id="tabs-3">
                        {% if texts|length > 0 %}
                            <ul>
                                {% for text in texts %}
                                    <li class="text">{{ text.text }} , {{ 'Votes'|trans }}: {{ text.votes }} {% if not voted %}<a class="vote button" participantid="{{ text.participantId }}" href="#">{{ 'Vote'|trans }}</a>{% endif %}</li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                        {% if files|length > 0 %}
                            <ul>
                                {% for file in files %}
                                    <li>{{ file.file.id }}, {{ 'Author'|trans }}: {{ file.author }}, {{ 'Votes'|trans }}: {{ file.votes }} {% if not voted %}<a class="vote button" participantid="{{ file.participantId }}" href="#">{{ 'Vote'|trans }}</a>{% endif %}</li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                        {% if addMoreParticipants %}
                            <div class="morelink">
                                <a id="addMoreElements" href="">{{ 'View more'|trans }}</a>
                            </div>
                        {% endif %}
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
    <div id="participateSplash" class="hidden">
        <div class="2">
            <textarea></textarea>
            <input type="button" value="{{ 'Submit'|trans }}"/>
        </div>
        <div class="3">
            
        </div>
        <div class="4">
            
        </div>
    </div>
    <div class="cont clearfix">
            {% include 'DodiciFansworldWebBundle:Comment:comment_block.html.twig' with {entity: contest} %}
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function(){
        contest.init();
    });
</script>
{% endblock %}
