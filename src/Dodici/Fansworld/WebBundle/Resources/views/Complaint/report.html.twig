{% extends "DodiciFansworldWebBundle::popup.html.twig" %}

{% block javascripts %}
	{{ parent() }}
	<script src="{{ asset('bundles/dodicifansworldweb/js/base.js') }}" type="text/javascript"></script>
{% endblock %}

{% block content %}
    {% if not reported%}
        <div id="report" style="height: 120px">
            <form id="complaintReport" name="report" method="post">
                <label>{{ 'Category'|trans }}:</label>
                <br/>
                <select name="category" id="category" class="category" style="width: 300px">
                    {% for category in categories %}
                        <option value="{{ category.id }}">{{ category }}</option>
                    {% endfor %}
                </select>
                <br/>
                <label>{{ 'Comment'|trans }}:</label>
                <br/>
                <textarea name="comment" id="comment" class="comment" style="width: 300px"></textarea>
                <br/>
                <input type="submit" name="submit" value="{{ 'Report'|trans }}" />
            </form>
        </div>

        <script type="text/javascript">
            $(document).ready(function(){
                $("#complaintReport").live('submit', function(){
                    ajax.genericAction('complaint_make', {
                        'type': '{{ entityType }}',
                        'id': {{ entityId }},
                        'comment': $("#complaintReport textarea.comment").val(),
                        'category': $("#complaintReport select option:selected").attr("value")
                    }, 
                    function(response){
                        console.log(response);
                        window.top.$.colorbox.close();
                    },
                    function(error){
                        console.error(error);
                    });
                    return false;
                });
            });
        </script>
    {% else %}
        <h2>{{ 'You\'ve already reported'|trans}}.</h2>
    {% endif %}
{% endblock %}
