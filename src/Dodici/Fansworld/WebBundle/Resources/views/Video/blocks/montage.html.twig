<!-- Listado de videos para mostrar como montage -->
{% if thumbnailSize is not defined %}
    {% set thumbnailSize = 'medium' %}
{% endif %}

{% if listFilters is not defined %}
    {% set listFilters = '' %}
{% else %}
    {% set listFilters = ' data-list-filters="' ~ listFilters ~ '"' %}
{% endif %}

{% if listFiltersElement is not defined %}
    {% set listFiltersElement = '' %}
{% else %}
    {% set listFiltersElement = ' data-list-filters-element="' ~ listFiltersElement ~ '"' %}
{% endif %}

{% if listChannels is not defined %}
    {% set listChannels = '' %}
{% else %}
    {% set listChannels = ' data-list-channels' %}
{% endif %}

{% if listResult is not defined %}
    {% set listResult = '' %}
{% else %}
    {% set listResult = ' data-list-result="' ~ listResult ~ '"' %}
{% endif %}

{% if listScrollable is not defined %}
    {% set listScrollable = '' %}
{% else %}
    {% set listScrollable = ' data-list-scrollable' %}
{% endif %}

{% if listFetchMoreButton is not defined %}
    {% set listFetchMoreButton = '' %}
{% else %}
    {% set listFetchMoreButton = ' data-list-fetch-more-button' %}
{% endif %}

{% if listIsMontage is not defined %}
    {% set listIsMontage = '' %}
{% else %}
    {% set listIsMontage = ' data-list-montage' %}
{% endif %}

{% if listId is not defined %}
    {% set listId = '' %}
{% else %}
    {% set listId = ' id="' ~ listId ~ '"' %}
{% endif %}

{% if listWithModal is not defined %}
    {% set listWithModal = '' %}
{% else %}
    {% set listWithModal = 'data-is-modal' %}
{% endif %}

{% if feedSource is not defined %}
    {% set feedSource = '' %}
{% else %}
    {% set feedSource = ' data-feed-source="' ~ feedSource ~ '"' %}
{% endif %}

{% set listParams = listFilters ~ listFiltersElement ~ listChannels ~ listResult ~ listScrollable ~ listFetchMoreButton ~ listIsMontage %}
<div class="row-fluid">
    {#<script>
        $(document).ready(function () {
            var videos = [
                {% if videos|length>0 %}
                {% for video in videos %}
                {
                    'id': {{video.id}},
                    'type': "video",
                    'image': "{{ appmedia.imageurl(video.image, 'video')}}",
                    'title': "{{video.title}}",
                    'slug': "{{video.slug}}",
                    'author': {'username': "{{video.author.username}}"},
                    'authorImage': "{{ appmedia.imageurl(video.author.image, 'avatar')}}"
                },
                {% endfor %}
                {% else %}
                {% endif %}
            ]
            return;
            var $container = $('body').find('.isotope_container').last();
            $container.empty();
            $container.addClass("isotope_container");
            $container.attr('data-feed-source', 'home_ajaxpopularfeed');

            var $spinner = $container.parent().find('.spinner');

            if (!$container.parent().hasClass('isIso')) {
                $spinner.removeClass('hidden');
                $container.fwGalerizer({
                    preoloadData: videos,
                    onEndless: function (plugin) {
                        $spinner.removeClass('hidden');
                        var lastDate = $('section.home-content .content-container[data-type-tab="popularFeed"] #elements .post').last().attr('data-element-date');
                        plugin.options.feedfilter = {
                            'date': lastDate
                        };
                        return plugin.options.feedfilter;
                    },
                    onGallery: function () {
                        $spinner.addClass('hidden');
                    }
                });
                $container.parent().addClass('isIso');
            }
            ;
        });
    </script>#}
    <div {{ listId|raw }} class="isotope_container" {{ listParams|raw }} {{ feedSource|raw }} data-ima-test="deadbeef"
                          data-list-result>
    </div>
    <div class="spinner hidden">
        <div class="mask"></div>
    </div>
</div>
